# Template file for 'zrythm'
pkgname=zrythm
version=0.8.982
revision=1
archs="~*-musl"
build_style=meson
build_helper=qemu
hostmakedepends="cmake gettext xdg-utils pkg-config guile glib-devel"
makedepends="libzstd-devel libcyaml reproc guile-devel lilv-devel libaudec-devel
 chromaprint-devel rubberband-devel fftw-devel gtk+3-devel gtksourceview4-devel libyaml-devel
 jack-devel alsa-lib-devel graphviz-devel SDL2-devel python3-Sphinx"
depends="breeze-icons"
short_desc="Highly automated and intuitive digital audio workstation"
maintainer="teldra <teldra@rotce.de>"
license="AGPL-3.0-or-later"
homepage="https://www.zrythm.org/"
distfiles="https://git.zrythm.org/cgit/zrythm/snapshot/zrythm-${version}.tar.gz"
checksum=73a63bbc636c780e7ddf86830601ea39546a4c9747d49438b74bc4cae2c4814d

if [ "$CROSS_BUILD" ]; then
	configure_args+=" -Dmanpage=false"
else
	hostmakedepends+=" help2man"
fi

case "$XBPS_TARGET_MACHINE" in
	arm*|aarch64)
		makedepends+=" libatomic_ops-devel"
esac

post_install() {
	# Move bash-completion to the correct dir.
	vmkdir usr/share/bash-completion/completions
	mv ${DESTDIR}/etc/bash_completion.d \
	${DESTDIR}/usr/share/bash-completion/completions
	vlicense COPYING
}
